(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6636],{1410:e=>{e.exports={loadingContainer:"LoadingCircle_loadingContainer__4xet2",spinner:"LoadingCircle_spinner__dFWsr","sk-bouncedelay":"LoadingCircle_sk-bouncedelay__pRt6I",small:"LoadingCircle_small__1YWT6",medium:"LoadingCircle_medium__2mbND",large:"LoadingCircle_large__LczEg",primary:"LoadingCircle_primary__11h_B",white:"LoadingCircle_white__DwiPc",gray:"LoadingCircle_gray__uCF8K",bounce1:"LoadingCircle_bounce1__A8X52",bounce2:"LoadingCircle_bounce2__exQJN",bounce3:"LoadingCircle_bounce3__mC4DJ",loadingText:"LoadingCircle_loadingText__EsdSU",circleSpinner:"LoadingCircle_circleSpinner__ziTn7",spin:"LoadingCircle_spin___kJ5O",fullPageOverlay:"LoadingCircle_fullPageOverlay__7R5zF",sectionLoading:"LoadingCircle_sectionLoading__fnPMj",cardSkeleton:"LoadingCircle_cardSkeleton__V99_0",loading:"LoadingCircle_loading__68KHW",productGridLoading:"LoadingCircle_productGridLoading__sV__P",productCardSkeleton:"LoadingCircle_productCardSkeleton__urXAf"}},2045:(e,a,t)=>{"use strict";t.d(a,{G:()=>o,j:()=>n});var r=t(4540);let n=()=>(0,r.wA)(),o=r.d4},2265:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>_,DY:()=>o,ET:()=>u,Lx:()=>n,l2:()=>i,ri:()=>d,uM:()=>p,w2:()=>l});var r=t(1990);let n=(0,r.zD)("auth/login",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await fetch("http://localhost:8000/api/v1/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();return t(e)}let r=await a.json();return localStorage.setItem("access_token",r.access),localStorage.setItem("refresh_token",r.refresh),r}catch(e){return t({message:"Ошибка сети"})}}),o=(0,r.zD)("auth/register",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await fetch("http://localhost:8000/api/v1/auth/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!a.ok){let e=await a.json();return t(e)}return await a.json()}catch(e){return t({message:"Ошибка сети"})}}),i=(0,r.zD)("auth/fetchProfile",async(e,a)=>{let{rejectWithValue:t,getState:r}=a;try{let e=r().auth.token||localStorage.getItem("access_token");if(!e)return t({message:"Нет токена авторизации"});let a=await fetch("http://localhost:8000/api/v1/auth/profile/",{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){if(401===a.status)throw Error("Token expired");let e=await a.json();return t(e)}return await a.json()}catch(e){return t({message:"Ошибка получения профиля"})}}),s=(0,r.zD)("auth/refreshToken",async(e,a)=>{let{rejectWithValue:t}=a;try{let e=localStorage.getItem("refresh_token");if(!e)return t({message:"Нет refresh токена"});let a=await fetch("http://localhost:8000/api/v1/auth/login/refresh/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!a.ok){let e=await a.json();return t(e)}let r=await a.json();return localStorage.setItem("access_token",r.access),r}catch(e){return t({message:"Ошибка обновления токена"})}}),l=(0,r.zD)("auth/requestPasswordReset",async(e,a)=>{let{rejectWithValue:t}=a;try{let a=await fetch("http://localhost:8000/api/v1/auth/password-reset/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!a.ok){let e=await a.json();return t(e)}return await a.json()}catch(e){return t({message:"Ошибка сети"})}}),c=(0,r.Z0)({name:"auth",initialState:{user:null,token:null,refreshToken:null,isLoading:!1,error:null,isAuthenticated:!1,isInitialized:!1},reducers:{logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},clearError:e=>{e.error=null},loadTokensFromStorage:e=>{let a=localStorage.getItem("access_token"),t=localStorage.getItem("refresh_token");a&&t&&(e.token=a,e.refreshToken=t,e.isAuthenticated=!0),e.isInitialized=!0},setTokens:(e,a)=>{e.token=a.payload.access,e.refreshToken=a.payload.refresh,e.isAuthenticated=!0}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,a)=>{e.isLoading=!1,e.token=a.payload.access,e.refreshToken=a.payload.refresh,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload,e.isAuthenticated=!1}).addCase(o.pending,e=>{e.isLoading=!0,e.error=null}).addCase(o.fulfilled,(e,a)=>{e.isLoading=!1,e.user=a.payload,e.error=null}).addCase(o.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload}).addCase(i.pending,e=>{e.isLoading=!0}).addCase(i.fulfilled,(e,a)=>{e.isLoading=!1,e.user=a.payload,e.error=null}).addCase(i.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload,e.isAuthenticated=!1,e.token=null,e.refreshToken=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}).addCase(s.fulfilled,(e,a)=>{e.token=a.payload.access}).addCase(s.rejected,e=>{e.isAuthenticated=!1,e.token=null,e.refreshToken=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}).addCase(l.pending,e=>{e.isLoading=!0,e.error=null}).addCase(l.fulfilled,e=>{e.isLoading=!1,e.error=null}).addCase(l.rejected,(e,a)=>{e.isLoading=!1,e.error=a.payload})}}),{logout:d,clearError:u,loadTokensFromStorage:p,setTokens:f}=c.actions,_=c.reducer},2621:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>_});var r=t(5155),n=t(2115),o=t(5695),i=t(2045),s=t(2265),l=t(5295);function c(e){let{children:a,redirectTo:t="/auth/login"}=e,{t:s}=(0,l.useI18n)(),{isAuthenticated:c,isLoading:d,isInitialized:u}=(0,i.G)(e=>e.auth);(0,i.j)();let p=(0,o.useRouter)();return((0,n.useEffect)(()=>{u&&!c&&p.push(t)},[u,c,p,t]),!u||d)?(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",flexDirection:"column",gap:"1rem"},children:[(0,r.jsx)("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f4f6",borderTop:"4px solid #6366f1",borderRadius:"50%",animation:"spin 1s linear infinite"}}),(0,r.jsx)("p",{style:{color:"#6b7280"},children:u?s("common.checkingAuth"):s("common.initializing")||"Initializing..."})]}):c?(0,r.jsx)(r.Fragment,{children:a}):null}var d=t(4060),u=t(7687),p=t.n(u);function f(){let{t:e}=(0,l.useI18n)(),[a,t]=(0,n.useState)(!1),[c,u]=(0,n.useState)({first_name:"",last_name:"",email:"",phone:""}),f=(0,i.j)(),_=(0,o.useRouter)(),{user:m,isLoading:h,isAuthenticated:g}=(0,i.G)(e=>e.auth);(0,n.useEffect)(()=>{m?u({first_name:m.first_name||"",last_name:m.last_name||"",email:m.email||"",phone:m.phone_number||""}):f((0,s.l2)())},[f,m]);let j=e=>{let{name:a,value:t}=e.target;u({...c,[a]:t})},x=async()=>{try{let e=localStorage.getItem("access_token");(await fetch("http://localhost:8000/api/v1/auth/profile/",{method:"PATCH",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"},body:JSON.stringify(c)})).ok&&(await f((0,s.l2)()),t(!1))}catch(e){console.error("Error updating profile:",e)}};return h?(0,r.jsx)("div",{className:p().profileContainer,children:(0,r.jsx)("div",{className:p().loadingContainer,children:(0,r.jsx)(d.A,{size:"large",color:"primary",text:e("profile.loading")})})}):m?(0,r.jsx)("div",{className:p().profileContainer,children:(0,r.jsxs)("div",{className:p().profileCard,children:[(0,r.jsxs)("div",{className:p().profileHeader,children:[(0,r.jsxs)("div",{className:p().avatarSection,children:[(0,r.jsx)("div",{className:p().avatar,children:m.first_name?m.first_name[0].toUpperCase():"П"}),(0,r.jsxs)("div",{className:p().userInfo,children:[(0,r.jsxs)("h1",{className:p().userName,children:[m.first_name," ",m.last_name]}),(0,r.jsx)("p",{className:p().userEmail,children:m.email})]})]}),(0,r.jsxs)("div",{className:p().actionButtons,children:["            ",(0,r.jsx)("button",{onClick:()=>t(!a),className:"".concat(p().button," ").concat(p().editButton),children:e(a?"profile.cancel":"profile.edit")}),(0,r.jsx)("button",{onClick:()=>{f((0,s.ri)()),_.push("/")},className:"".concat(p().button," ").concat(p().logoutButton),children:e("profile.logout")})]})]}),(0,r.jsxs)("div",{className:p().profileContent,children:["          ",(0,r.jsxs)("div",{className:p().section,children:[(0,r.jsx)("h2",{className:p().sectionTitle,children:e("profile.personalInfo.title")}),(0,r.jsxs)("div",{className:p().formGrid,children:[(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().formLabel,children:e("profile.personalInfo.firstName")}),a?(0,r.jsx)("input",{type:"text",name:"first_name",value:c.first_name,onChange:j,className:p().formInput}):(0,r.jsx)("p",{className:p().formValue,children:m.first_name||e("profile.notSpecified")})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().formLabel,children:e("profile.personalInfo.lastName")}),a?(0,r.jsx)("input",{type:"text",name:"last_name",value:c.last_name,onChange:j,className:p().formInput}):(0,r.jsx)("p",{className:p().formValue,children:m.last_name||e("profile.notSpecified")})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().formLabel,children:e("profile.personalInfo.email")}),a?(0,r.jsx)("input",{type:"email",name:"email",value:c.email,onChange:j,className:p().formInput}):(0,r.jsx)("p",{className:p().formValue,children:m.email})]}),(0,r.jsxs)("div",{className:p().formGroup,children:[(0,r.jsx)("label",{className:p().formLabel,children:e("profile.personalInfo.phone")}),a?(0,r.jsx)("input",{type:"tel",name:"phone",value:c.phone,onChange:j,className:p().formInput,placeholder:e("profile.personalInfo.phonePlaceholder")}):(0,r.jsx)("p",{className:p().formValue,children:m.phone_number||e("profile.notSpecified")})]})]}),"            ",a&&(0,r.jsx)("div",{className:p().saveActions,children:(0,r.jsx)("button",{onClick:x,className:"".concat(p().button," ").concat(p().saveButton),children:e("profile.saveChanges")})})]}),"          ",(0,r.jsxs)("div",{className:p().section,children:[(0,r.jsx)("h2",{className:p().sectionTitle,children:e("profile.accountSettings.title")}),(0,r.jsxs)("div",{className:p().settingsGrid,children:[(0,r.jsxs)("div",{className:p().settingItem,children:[(0,r.jsxs)("div",{className:p().settingInfo,children:[(0,r.jsx)("h3",{className:p().settingTitle,children:e("profile.accountSettings.changePassword.title")}),(0,r.jsx)("p",{className:p().settingDescription,children:e("profile.accountSettings.changePassword.description")})]}),(0,r.jsx)("button",{className:"".concat(p().button," ").concat(p().secondaryButton),children:e("profile.accountSettings.changePassword.button")})]}),(0,r.jsxs)("div",{className:p().settingItem,children:[(0,r.jsxs)("div",{className:p().settingInfo,children:[(0,r.jsx)("h3",{className:p().settingTitle,children:e("profile.accountSettings.notifications.title")}),(0,r.jsx)("p",{className:p().settingDescription,children:e("profile.accountSettings.notifications.description")})]}),(0,r.jsx)("button",{className:"".concat(p().button," ").concat(p().secondaryButton),children:e("profile.accountSettings.notifications.button")})]})]})]}),"          ",(0,r.jsxs)("div",{className:p().section,children:[(0,r.jsx)("h2",{className:p().sectionTitle,children:e("profile.orders.title")}),(0,r.jsxs)("div",{className:p().ordersPlaceholder,children:[(0,r.jsx)("p",{className:p().placeholderText,children:e("profile.orders.noOrders")}),(0,r.jsx)("button",{className:"".concat(p().button," ").concat(p().primaryButton),children:e("profile.orders.startShopping")})]})]})]})]})}):null}function _(){return(0,r.jsx)(c,{children:(0,r.jsx)(f,{})})}},2979:(e,a,t)=>{Promise.resolve().then(t.bind(t,2621))},4060:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var r=t(5155);t(2115);var n=t(1410),o=t.n(n);let i=e=>{let{size:a="medium",color:t="primary",text:n,className:i=""}=e;return(0,r.jsxs)("div",{className:"".concat(o().loadingContainer," ").concat(i),children:[(0,r.jsxs)("div",{className:"".concat(o().spinner," ").concat(o()[a]," ").concat(o()[t]),children:[(0,r.jsx)("div",{className:o().bounce1}),(0,r.jsx)("div",{className:o().bounce2}),(0,r.jsx)("div",{className:o().bounce3})]}),n&&(0,r.jsx)("p",{className:o().loadingText,children:n})]})}},5695:(e,a,t)=>{"use strict";var r=t(8999);t.o(r,"useParams")&&t.d(a,{useParams:function(){return r.useParams}}),t.o(r,"usePathname")&&t.d(a,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(a,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(a,{useSearchParams:function(){return r.useSearchParams}})},7687:e=>{e.exports={profileContainer:"profile_profileContainer__4OeWo",profileCard:"profile_profileCard__HJ2Cz",profileHeader:"profile_profileHeader__Xf6f4",avatarSection:"profile_avatarSection__fZnTm",avatar:"profile_avatar__f2UDF",userInfo:"profile_userInfo__oWr8Y",userEmail:"profile_userEmail__ts0FE",actionButtons:"profile_actionButtons__rDFEg",button:"profile_button___xNux",editButton:"profile_editButton__oGUfC",logoutButton:"profile_logoutButton__Vjcxn",profileContent:"profile_profileContent__eyz94",section:"profile_section__RH7dI",sectionTitle:"profile_sectionTitle___Vi78",formGrid:"profile_formGrid__nDn3z",formGroup:"profile_formGroup__umLr_",formLabel:"profile_formLabel__dy9_j",formInput:"profile_formInput__r84gq",formValue:"profile_formValue__S31WS",saveActions:"profile_saveActions__PSj27",saveButton:"profile_saveButton__Vp6f_",primaryButton:"profile_primaryButton__MNKcw",secondaryButton:"profile_secondaryButton__qgiP9",settingsGrid:"profile_settingsGrid__VETua",settingItem:"profile_settingItem__Z5eF1",settingInfo:"profile_settingInfo__rp9Jq",settingDescription:"profile_settingDescription__Kr5b2",ordersPlaceholder:"profile_ordersPlaceholder__JRe7m",placeholderText:"profile_placeholderText__LSZEX",loadingSpinner:"profile_loadingSpinner__LmX3z",spinner:"profile_spinner__0gF1W",spin:"profile_spin__B8_d_"}}},e=>{var a=a=>e(e.s=a);e.O(0,[2181,4540,1990,5295,8441,1684,7358],()=>a(2979)),_N_E=e.O()}]);