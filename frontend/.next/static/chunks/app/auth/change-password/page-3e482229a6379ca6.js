(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2796],{22:(s,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>w});var r=a(5155),o=a(2115),n=a(5695),l=a(6874),d=a.n(l),t=a(2045),c=a(171),i=a(5910),h=a.n(i);function w(){let{t:s}=(0,c.useI18n)(),[e,a]=(0,o.useState)({oldPassword:"",newPassword:"",confirmPassword:""}),[l,i]=(0,o.useState)(!1),[w,m]=(0,o.useState)(!1),[u,p]=(0,o.useState)(!1),[x,j]=(0,o.useState)({}),[N,P]=(0,o.useState)(!1),[f,v]=(0,o.useState)(!1),b=(0,n.useRouter)(),{user:g,token:y}=(0,t.G)(s=>s.auth);if(!g||!y)return b.push("/auth/login"),null;let C=()=>{let s={};return e.oldPassword||(s.oldPassword="Текущий пароль обязателен"),e.newPassword?e.newPassword.length<8&&(s.newPassword="Пароль должен содержать минимум 8 символов"):s.newPassword="Новый пароль обязателен",e.confirmPassword?e.newPassword!==e.confirmPassword&&(s.confirmPassword="Пароли не совпадают"):s.confirmPassword="Подтвердите новый пароль",j(s),0===Object.keys(s).length},_=async s=>{if(s.preventDefault(),C()){v(!0),j({});try{let s=await fetch("http://localhost:8000/api/v1/auth/change-password/",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(y)},body:JSON.stringify({old_password:e.oldPassword,new_password:e.newPassword,new_password2:e.confirmPassword})});if(s.ok)P(!0),a({oldPassword:"",newPassword:"",confirmPassword:""});else{let e=await s.json();j(e)}}catch(s){j({general:"Ошибка сети. Попробуйте позже."})}finally{v(!1)}}},k=s=>{let{name:r,value:o}=s.target;a({...e,[r]:o}),x[r]&&j({...x,[r]:""})};return N?(0,r.jsx)("div",{className:h().authContainer,children:(0,r.jsxs)("div",{className:h().authCard,children:[(0,r.jsxs)("div",{className:h().authHeader,children:[(0,r.jsx)("h1",{className:h().authTitle,children:"Пароль изменен"}),(0,r.jsx)("p",{className:h().authSubtitle,children:"Ваш пароль был успешно изменен"})]}),(0,r.jsxs)("div",{className:h().successMessage,children:[(0,r.jsx)("div",{className:h().successIcon,children:"✓"}),(0,r.jsx)("p",{children:"Пароль обновлен. Пожалуйста, используйте новый пароль при следующем входе."})]}),(0,r.jsxs)("div",{className:h().authFooter,children:[(0,r.jsx)(d(),{href:"/profile",className:h().linkButton,children:"Вернуться в профиль"}),(0,r.jsx)(d(),{href:"/",className:h().authLink,children:"На главную"})]})]})}):(0,r.jsx)("div",{className:h().authContainer,children:(0,r.jsxs)("div",{className:h().authCard,children:[(0,r.jsxs)("div",{className:h().authHeader,children:[(0,r.jsx)("h1",{className:h().authTitle,children:"Изменить пароль"}),(0,r.jsx)("p",{className:h().authSubtitle,children:"Введите текущий пароль и новый пароль"})]}),(0,r.jsxs)("form",{onSubmit:_,className:h().authForm,children:[x.general&&(0,r.jsx)("div",{className:h().errorMessage,children:x.general}),(0,r.jsxs)("div",{className:h().formGroup,children:[(0,r.jsx)("label",{htmlFor:"oldPassword",className:h().formLabel,children:"Текущий пароль"}),(0,r.jsxs)("div",{className:h().passwordWrapper,children:[(0,r.jsx)("input",{type:l?"text":"password",id:"oldPassword",name:"oldPassword",value:e.oldPassword,onChange:k,className:"".concat(h().formInput," ").concat(x.oldPassword?h().inputError:""),placeholder:"Введите текущий пароль",required:!0}),(0,r.jsx)("button",{type:"button",className:h().passwordToggle,onClick:()=>i(!l),children:l?"\uD83D\uDE48":"\uD83D\uDC41️"})]}),x.oldPassword&&(0,r.jsx)("span",{className:h().errorText,children:x.oldPassword}),x.old_password&&(0,r.jsx)("span",{className:h().errorText,children:x.old_password})]}),(0,r.jsxs)("div",{className:h().formGroup,children:[(0,r.jsx)("label",{htmlFor:"newPassword",className:h().formLabel,children:"Новый пароль"}),(0,r.jsxs)("div",{className:h().passwordWrapper,children:[(0,r.jsx)("input",{type:w?"text":"password",id:"newPassword",name:"newPassword",value:e.newPassword,onChange:k,className:"".concat(h().formInput," ").concat(x.newPassword?h().inputError:""),placeholder:"Введите новый пароль",required:!0}),(0,r.jsx)("button",{type:"button",className:h().passwordToggle,onClick:()=>m(!w),children:w?"\uD83D\uDE48":"\uD83D\uDC41️"})]}),x.newPassword&&(0,r.jsx)("span",{className:h().errorText,children:x.newPassword}),x.new_password&&(0,r.jsx)("span",{className:h().errorText,children:x.new_password})]}),(0,r.jsxs)("div",{className:h().formGroup,children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:h().formLabel,children:"Подтвердите новый пароль"}),(0,r.jsxs)("div",{className:h().passwordWrapper,children:[(0,r.jsx)("input",{type:u?"text":"password",id:"confirmPassword",name:"confirmPassword",value:e.confirmPassword,onChange:k,className:"".concat(h().formInput," ").concat(x.confirmPassword?h().inputError:""),placeholder:"Подтвердите новый пароль",required:!0}),(0,r.jsx)("button",{type:"button",className:h().passwordToggle,onClick:()=>p(!u),children:u?"\uD83D\uDE48":"\uD83D\uDC41️"})]}),x.confirmPassword&&(0,r.jsx)("span",{className:h().errorText,children:x.confirmPassword})]}),(0,r.jsx)("button",{type:"submit",disabled:f,className:"".concat(h().authButton," ").concat(h().primaryButton),children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:h().spinner}),"Сохранение..."]}):"Изменить пароль"})]}),(0,r.jsx)("div",{className:h().authFooter,children:(0,r.jsx)(d(),{href:"/profile",className:h().authLink,children:"Отмена"})})]})})}},2696:(s,e,a)=>{Promise.resolve().then(a.bind(a,22))}},s=>{var e=e=>s(s.s=e);s.O(0,[9614,5829,6707,9800,2352,6530,2214,5748,2333,8187,5980,4676,7698,1659,8538,3516,901,9857,8268,4170,7635,9670,7593,6861,5885,7128,6136,9064,3743,5377,1980,7137,1880,4297,2868,4681,4833,6986,9002,9466,7692,6451,6373,8852,8096,7358],()=>e(2696)),_N_E=s.O()}]);