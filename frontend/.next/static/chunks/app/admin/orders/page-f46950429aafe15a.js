(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4798],{1706:(e,n,d)=>{Promise.resolve().then(d.bind(d,9720))},4685:e=>{e.exports={adminOrdersPage:"adminOrders_adminOrdersPage__Fbfm9",container:"adminOrders_container__3gUtJ",header:"adminOrders_header__CpPp2",loadingContainer:"adminOrders_loadingContainer__rjMOX",spinner:"adminOrders_spinner__J4frj",spin:"adminOrders_spin__6KrDi",errorContainer:"adminOrders_errorContainer__mEc3f",filters:"adminOrders_filters__3gkNo",statusFilter:"adminOrders_statusFilter__f8DQj",ordersGrid:"adminOrders_ordersGrid__fY76t",orderCard:"adminOrders_orderCard__TWsTR",orderHeader:"adminOrders_orderHeader__2DRuZ",orderId:"adminOrders_orderId__ok9vm",status:"adminOrders_status__ZmTVE",pending_payment:"adminOrders_pending_payment__cpOsi",processing:"adminOrders_processing__Uz2RV",shipped:"adminOrders_shipped__04LjW",delivered:"adminOrders_delivered__Zxhn_",cancelled:"adminOrders_cancelled__MoI3O",refunded:"adminOrders_refunded___TKsA",failed:"adminOrders_failed__S7WiA",orderDetails:"adminOrders_orderDetails__LsdQQ",paymentStatus:"adminOrders_paymentStatus__KLQ9J",payment_pending:"adminOrders_payment_pending__AXU2h",payment_paid:"adminOrders_payment_paid__t1kR2",payment_failed:"adminOrders_payment_failed__Q_Mjm",payment_refunded:"adminOrders_payment_refunded__zduGE",paymentActions:"adminOrders_paymentActions__ocJaQ",paymentButtons:"adminOrders_paymentButtons__oZ6cz",paymentButton:"adminOrders_paymentButton__OLb1D",pendingButton:"adminOrders_pendingButton__HWYIx",paidButton:"adminOrders_paidButton__k2k_e",failedButton:"adminOrders_failedButton__JjQUj",refundedButton:"adminOrders_refundedButton__nyJEp",orderActions:"adminOrders_orderActions__6SWfX",viewButton:"adminOrders_viewButton__39G6e",emptyState:"adminOrders_emptyState___3K7i"}},9720:(e,n,d)=>{"use strict";d.r(n),d.d(n,{default:()=>_});var a=d(5155),r=d(2115),t=d(4540),s=d(5695),i=d(171),o=d(4685),l=d.n(o);let c="http://localhost:8000/api/v1";function _(){let{t:e}=(0,i.useI18n)(),n=(0,s.useRouter)(),{isAuthenticated:d,user:o,isInitialized:_}=(0,t.d4)(e=>e.auth),[p,u]=(0,r.useState)([]),[m,h]=(0,r.useState)(!0),[f,y]=(0,r.useState)(null),[j,g]=(0,r.useState)("all"),[x,v]=(0,r.useState)("all"),[O,N]=(0,r.useState)(null);(0,r.useEffect)(()=>{if(_&&(!d||!(null==o?void 0:o.is_staff)))return void n.push("/")},[_,d,o,n]),(0,r.useEffect)(()=>{let e=async()=>{if(d&&(null==o?void 0:o.is_staff)){h(!0),y(null);try{let e=localStorage.getItem("access_token");if(!e)return void y("No access token found");let n=await fetch("".concat(c,"/admin/orders/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!n.ok)throw Error("Failed to load orders");let d=await n.json();u(d.results||[])}catch(e){console.error("Error loading admin orders:",e),y("Failed to load orders")}finally{h(!1)}}};d&&(null==o?void 0:o.is_staff)&&e()},[d,o]);let C=async(e,n)=>{if(d&&(null==o?void 0:o.is_staff)){N(e);try{let d=localStorage.getItem("access_token");if(!d)return void y("No access token found");let a=await fetch("".concat(c,"/admin/orders/").concat(e,"/update_payment_status/"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(d),"Content-Type":"application/json"},body:JSON.stringify({payment_status:n})});if(!a.ok)throw Error("Failed to update payment status");let r=await a.json();u(n=>n.map(n=>n.order_id===e?{...n,payment_status:r.payment_status}:n))}catch(e){console.error("Error updating payment status:",e),y("Failed to update payment status")}finally{N(null)}}},B=p.filter(e=>{let n="all"===j||e.order_status===j,d="all"===x||e.payment_status===x;return n&&d});return!_||m?(0,a.jsxs)("div",{className:l().loadingContainer,children:[(0,a.jsx)("div",{className:l().spinner}),(0,a.jsx)("p",{children:"Loading orders..."})]}):d&&(null==o?void 0:o.is_staff)?f?(0,a.jsxs)("div",{className:l().errorContainer,children:[(0,a.jsx)("h2",{children:"Error"}),(0,a.jsx)("p",{children:f})]}):(0,a.jsx)("div",{className:l().adminOrdersPage,children:(0,a.jsxs)("div",{className:l().container,children:[(0,a.jsxs)("div",{className:l().header,children:[(0,a.jsx)("h1",{children:"Admin - Order Management"}),(0,a.jsx)("p",{children:"Manage all orders in the system"})]}),"        ",(0,a.jsxs)("div",{className:l().filters,children:["          ",(0,a.jsxs)("select",{value:j,onChange:e=>g(e.target.value),className:l().statusFilter,children:[(0,a.jsx)("option",{value:"all",children:"All Order Status"},"all-order-status"),(0,a.jsx)("option",{value:"pending_payment",children:"Pending Payment"},"pending_payment"),(0,a.jsx)("option",{value:"processing",children:"Processing"},"processing"),(0,a.jsx)("option",{value:"shipped",children:"Shipped"},"shipped"),(0,a.jsx)("option",{value:"delivered",children:"Delivered"},"delivered"),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"},"cancelled"),(0,a.jsx)("option",{value:"refunded",children:"Refunded"},"refunded"),(0,a.jsx)("option",{value:"failed",children:"Failed"},"failed")]}),(0,a.jsxs)("select",{value:x,onChange:e=>v(e.target.value),className:l().statusFilter,children:[(0,a.jsx)("option",{value:"all",children:"All Payment Status"},"all-payment-status"),(0,a.jsx)("option",{value:"pending",children:"Pending"},"pending-payment"),(0,a.jsx)("option",{value:"paid",children:"Paid"},"paid-payment"),(0,a.jsx)("option",{value:"failed",children:"Failed"},"failed-payment"),(0,a.jsx)("option",{value:"refunded",children:"Refunded"},"refunded-payment")]})]}),"        ",(0,a.jsx)("div",{className:l().ordersGrid,children:0===B.length?(0,a.jsxs)("div",{className:l().emptyState,children:[(0,a.jsx)("h3",{children:"No orders found"}),(0,a.jsx)("p",{children:"No orders match the current filters."})]}):B.map((e,d)=>(0,a.jsxs)("div",{className:l().orderCard,children:[(0,a.jsxs)("div",{className:l().orderHeader,children:[(0,a.jsxs)("span",{className:l().orderId,children:["Order #",e.order_id]}),(0,a.jsx)("span",{className:"".concat(l().status," ").concat(l()[e.order_status||"pending_payment"]),children:(e.order_status||"pending_payment").toUpperCase().replace("_"," ")})]}),"                ",(0,a.jsxs)("div",{className:l().orderDetails,children:[(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Customer:"})," ",e.user_email]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Total:"})," $",e.total_amount]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Payment Status:"}),(0,a.jsx)("span",{className:"".concat(l().paymentStatus," ").concat(l()["payment_".concat(e.payment_status||"pending")]),children:(e.payment_status||"pending").toUpperCase()})]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Created:"})," ",new Date(e.created_at).toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:l().paymentActions,children:[(0,a.jsx)("h4",{children:"Update Payment Status:"}),"                  ",(0,a.jsxs)("div",{className:l().paymentButtons,children:[(0,a.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().pendingButton),onClick:()=>C(e.order_id,"pending"),disabled:O===e.order_id||"pending"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Pending"},"order-".concat(e.order_id||d,"-pending")),(0,a.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().paidButton),onClick:()=>C(e.order_id,"paid"),disabled:O===e.order_id||"paid"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Paid"},"order-".concat(e.order_id||d,"-paid")),(0,a.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().failedButton),onClick:()=>C(e.order_id,"failed"),disabled:O===e.order_id||"failed"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Failed"},"order-".concat(e.order_id||d,"-failed")),(0,a.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().refundedButton),onClick:()=>C(e.order_id,"refunded"),disabled:O===e.order_id||"refunded"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Refunded"},"order-".concat(e.order_id||d,"-refunded"))]})]}),"                ",(0,a.jsxs)("div",{className:l().orderActions,children:[(0,a.jsx)("button",{className:l().viewButton,onClick:()=>n.push("/admin/orders/".concat(e.order_id)),children:"View Details"}),"                "]})]},"order-".concat(e.order_id||d)))})]})}):null}}},e=>{var n=n=>e(e.s=n);e.O(0,[8190,6707,9800,2352,6530,2214,5748,2333,8187,5980,4676,7698,1659,8538,3516,901,9857,8268,4170,7635,9670,7593,6861,5885,7128,6136,9064,3743,5377,1980,7137,1880,4297,2868,4681,4833,6986,9717,6886,7692,6451,6373,8852,8096,7358],()=>n(1706)),_N_E=e.O()}]);