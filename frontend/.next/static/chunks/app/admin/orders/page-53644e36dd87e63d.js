(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4798],{3290:(e,a,n)=>{Promise.resolve().then(n.bind(n,9720))},4685:e=>{e.exports={adminOrdersPage:"adminOrders_adminOrdersPage__Fbfm9",container:"adminOrders_container__3gUtJ",header:"adminOrders_header__CpPp2",loadingContainer:"adminOrders_loadingContainer__rjMOX",spinner:"adminOrders_spinner__J4frj",spin:"adminOrders_spin__6KrDi",errorContainer:"adminOrders_errorContainer__mEc3f",filters:"adminOrders_filters__3gkNo",statusFilter:"adminOrders_statusFilter__f8DQj",ordersGrid:"adminOrders_ordersGrid__fY76t",orderCard:"adminOrders_orderCard__TWsTR",orderHeader:"adminOrders_orderHeader__2DRuZ",orderId:"adminOrders_orderId__ok9vm",status:"adminOrders_status__ZmTVE",pending_payment:"adminOrders_pending_payment__cpOsi",processing:"adminOrders_processing__Uz2RV",shipped:"adminOrders_shipped__04LjW",delivered:"adminOrders_delivered__Zxhn_",cancelled:"adminOrders_cancelled__MoI3O",refunded:"adminOrders_refunded___TKsA",failed:"adminOrders_failed__S7WiA",orderDetails:"adminOrders_orderDetails__LsdQQ",paymentStatus:"adminOrders_paymentStatus__KLQ9J",payment_pending:"adminOrders_payment_pending__AXU2h",payment_paid:"adminOrders_payment_paid__t1kR2",payment_failed:"adminOrders_payment_failed__Q_Mjm",payment_refunded:"adminOrders_payment_refunded__zduGE",paymentActions:"adminOrders_paymentActions__ocJaQ",paymentButtons:"adminOrders_paymentButtons__oZ6cz",paymentButton:"adminOrders_paymentButton__OLb1D",pendingButton:"adminOrders_pendingButton__HWYIx",paidButton:"adminOrders_paidButton__k2k_e",failedButton:"adminOrders_failedButton__JjQUj",refundedButton:"adminOrders_refundedButton__nyJEp",orderActions:"adminOrders_orderActions__6SWfX",viewButton:"adminOrders_viewButton__39G6e",emptyState:"adminOrders_emptyState___3K7i"}},5695:(e,a,n)=>{"use strict";var r=n(8999);n.o(r,"useParams")&&n.d(a,{useParams:function(){return r.useParams}}),n.o(r,"usePathname")&&n.d(a,{usePathname:function(){return r.usePathname}}),n.o(r,"useRouter")&&n.d(a,{useRouter:function(){return r.useRouter}}),n.o(r,"useSearchParams")&&n.d(a,{useSearchParams:function(){return r.useSearchParams}})},9720:(e,a,n)=>{"use strict";n.r(a),n.d(a,{default:()=>_});var r=n(5155),d=n(2115),t=n(4540),s=n(5695),i=n(5295),o=n(4685),l=n.n(o);let c="http://localhost:8000/api/v1";function _(){let{t:e}=(0,i.useI18n)(),a=(0,s.useRouter)(),{isAuthenticated:n,user:o,isInitialized:_}=(0,t.d4)(e=>e.auth),[u,p]=(0,d.useState)([]),[m,h]=(0,d.useState)(!0),[f,y]=(0,d.useState)(null),[j,g]=(0,d.useState)("all"),[x,v]=(0,d.useState)("all"),[O,N]=(0,d.useState)(null);(0,d.useEffect)(()=>{if(_&&(!n||!(null==o?void 0:o.is_staff)))return void a.push("/")},[_,n,o,a]),(0,d.useEffect)(()=>{let e=async()=>{if(n&&(null==o?void 0:o.is_staff)){h(!0),y(null);try{let e=localStorage.getItem("access_token");if(!e)return void y("No access token found");let a=await fetch("".concat(c,"/admin/orders/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok)throw Error("Failed to load orders");let n=await a.json();p(n.results||[])}catch(e){console.error("Error loading admin orders:",e),y("Failed to load orders")}finally{h(!1)}}};n&&(null==o?void 0:o.is_staff)&&e()},[n,o]);let C=async(e,a)=>{if(n&&(null==o?void 0:o.is_staff)){N(e);try{let n=localStorage.getItem("access_token");if(!n)return void y("No access token found");let r=await fetch("".concat(c,"/admin/orders/").concat(e,"/update_payment_status/"),{method:"PATCH",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({payment_status:a})});if(!r.ok)throw Error("Failed to update payment status");let d=await r.json();p(a=>a.map(a=>a.order_id===e?{...a,payment_status:d.payment_status}:a))}catch(e){console.error("Error updating payment status:",e),y("Failed to update payment status")}finally{N(null)}}},B=u.filter(e=>{let a="all"===j||e.order_status===j,n="all"===x||e.payment_status===x;return a&&n});return!_||m?(0,r.jsxs)("div",{className:l().loadingContainer,children:[(0,r.jsx)("div",{className:l().spinner}),(0,r.jsx)("p",{children:"Loading orders..."})]}):n&&(null==o?void 0:o.is_staff)?f?(0,r.jsxs)("div",{className:l().errorContainer,children:[(0,r.jsx)("h2",{children:"Error"}),(0,r.jsx)("p",{children:f})]}):(0,r.jsx)("div",{className:l().adminOrdersPage,children:(0,r.jsxs)("div",{className:l().container,children:[(0,r.jsxs)("div",{className:l().header,children:[(0,r.jsx)("h1",{children:"Admin - Order Management"}),(0,r.jsx)("p",{children:"Manage all orders in the system"})]}),"        ",(0,r.jsxs)("div",{className:l().filters,children:["          ",(0,r.jsxs)("select",{value:j,onChange:e=>g(e.target.value),className:l().statusFilter,children:[(0,r.jsx)("option",{value:"all",children:"All Order Status"},"all-order-status"),(0,r.jsx)("option",{value:"pending_payment",children:"Pending Payment"},"pending_payment"),(0,r.jsx)("option",{value:"processing",children:"Processing"},"processing"),(0,r.jsx)("option",{value:"shipped",children:"Shipped"},"shipped"),(0,r.jsx)("option",{value:"delivered",children:"Delivered"},"delivered"),(0,r.jsx)("option",{value:"cancelled",children:"Cancelled"},"cancelled"),(0,r.jsx)("option",{value:"refunded",children:"Refunded"},"refunded"),(0,r.jsx)("option",{value:"failed",children:"Failed"},"failed")]}),(0,r.jsxs)("select",{value:x,onChange:e=>v(e.target.value),className:l().statusFilter,children:[(0,r.jsx)("option",{value:"all",children:"All Payment Status"},"all-payment-status"),(0,r.jsx)("option",{value:"pending",children:"Pending"},"pending-payment"),(0,r.jsx)("option",{value:"paid",children:"Paid"},"paid-payment"),(0,r.jsx)("option",{value:"failed",children:"Failed"},"failed-payment"),(0,r.jsx)("option",{value:"refunded",children:"Refunded"},"refunded-payment")]})]}),"        ",(0,r.jsx)("div",{className:l().ordersGrid,children:0===B.length?(0,r.jsxs)("div",{className:l().emptyState,children:[(0,r.jsx)("h3",{children:"No orders found"}),(0,r.jsx)("p",{children:"No orders match the current filters."})]}):B.map((e,n)=>(0,r.jsxs)("div",{className:l().orderCard,children:[(0,r.jsxs)("div",{className:l().orderHeader,children:[(0,r.jsxs)("span",{className:l().orderId,children:["Order #",e.order_id]}),(0,r.jsx)("span",{className:"".concat(l().status," ").concat(l()[e.order_status||"pending_payment"]),children:(e.order_status||"pending_payment").toUpperCase().replace("_"," ")})]}),"                ",(0,r.jsxs)("div",{className:l().orderDetails,children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Customer:"})," ",e.user_email]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Total:"})," $",e.total_amount]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Payment Status:"}),(0,r.jsx)("span",{className:"".concat(l().paymentStatus," ").concat(l()["payment_".concat(e.payment_status||"pending")]),children:(e.payment_status||"pending").toUpperCase()})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Created:"})," ",new Date(e.created_at).toLocaleDateString()]})]}),(0,r.jsxs)("div",{className:l().paymentActions,children:[(0,r.jsx)("h4",{children:"Update Payment Status:"}),"                  ",(0,r.jsxs)("div",{className:l().paymentButtons,children:[(0,r.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().pendingButton),onClick:()=>C(e.order_id,"pending"),disabled:O===e.order_id||"pending"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Pending"},"order-".concat(e.order_id||n,"-pending")),(0,r.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().paidButton),onClick:()=>C(e.order_id,"paid"),disabled:O===e.order_id||"paid"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Paid"},"order-".concat(e.order_id||n,"-paid")),(0,r.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().failedButton),onClick:()=>C(e.order_id,"failed"),disabled:O===e.order_id||"failed"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Failed"},"order-".concat(e.order_id||n,"-failed")),(0,r.jsx)("button",{className:"".concat(l().paymentButton," ").concat(l().refundedButton),onClick:()=>C(e.order_id,"refunded"),disabled:O===e.order_id||"refunded"===e.payment_status,children:O===e.order_id?"Updating...":"Mark Refunded"},"order-".concat(e.order_id||n,"-refunded"))]})]}),"                ",(0,r.jsxs)("div",{className:l().orderActions,children:[(0,r.jsx)("button",{className:l().viewButton,onClick:()=>a.push("/admin/orders/".concat(e.order_id)),children:"View Details"}),"                "]})]},"order-".concat(e.order_id||n)))})]})}):null}}},e=>{var a=a=>e(e.s=a);e.O(0,[8190,4540,5295,8441,1684,7358],()=>a(3290)),_N_E=e.O()}]);