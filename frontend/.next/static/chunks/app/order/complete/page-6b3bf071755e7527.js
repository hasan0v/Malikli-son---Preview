(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5501],{1451:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>m});var s=r(5155),a=r(2115),o=r(5695),n=r(4540),i=r(5295),l=r(9493),c=r(3447),d=r.n(c);function m(){let{t:e}=(0,i.useI18n)(),t=(0,o.useRouter)(),r=(0,o.useSearchParams)(),{isAuthenticated:c}=(0,n.d4)(e=>e.auth),[m,u]=(0,a.useState)(null),[p,_]=(0,a.useState)(!0),[h,g]=(0,a.useState)(null),f=null==r?void 0:r.get("orderId");(0,a.useEffect)(()=>{let e=async()=>{if(!f){g("Order ID not found"),_(!1);return}try{let e=localStorage.getItem("access_token");if(!e){g("Authentication required"),_(!1);return}let t=await (0,l.p)(f,e);u(t)}catch(e){console.error("Failed to load order:",e),g(e instanceof Error?e.message:"Failed to load order details")}finally{_(!1)}};c?e():_(!1)},[f,c]);let C=e=>"string"==typeof e?parseFloat(e):e,j=e=>C(e).toFixed(2),x=()=>{t.push("/")};return p?(0,s.jsx)("div",{className:d().completePage,children:(0,s.jsx)("div",{className:d().container,children:(0,s.jsxs)("div",{className:d().loadingState,children:[(0,s.jsx)("div",{className:d().spinner}),(0,s.jsx)("p",{children:e("orderComplete.loading")})]})})}):h?(0,s.jsx)("div",{className:d().completePage,children:(0,s.jsx)("div",{className:d().container,children:(0,s.jsxs)("div",{className:d().errorState,children:[(0,s.jsx)("div",{className:d().errorIcon,children:"⚠️"}),(0,s.jsx)("h1",{className:d().errorTitle,children:e("orderComplete.error.title")}),(0,s.jsx)("p",{className:d().errorMessage,children:h}),(0,s.jsxs)("div",{className:d().actions,children:[(0,s.jsx)("button",{onClick:()=>t.push("/orders"),className:d().primaryButton,children:e("orderComplete.error.viewOrders")}),(0,s.jsx)("button",{onClick:x,className:d().secondaryButton,children:e("orderComplete.error.backHome")})]})]})})}):(0,s.jsx)("div",{className:d().completePage,children:(0,s.jsx)("div",{className:d().container,children:(0,s.jsxs)("div",{className:d().successState,children:[(0,s.jsx)("div",{className:d().successIcon,children:(0,s.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"#10B981"}),(0,s.jsx)("path",{d:"m9 12 2 2 4-4",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),(0,s.jsx)("h1",{className:d().successTitle,children:e("orderComplete.success.title")}),(0,s.jsx)("p",{className:d().successMessage,children:e("orderComplete.success.message")}),m&&(0,s.jsxs)("div",{className:d().orderSummary,children:[(0,s.jsx)("h2",{className:d().summaryTitle,children:e("orderComplete.summary.title")}),(0,s.jsxs)("div",{className:d().summaryGrid,children:[(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsxs)("span",{className:d().label,children:[e("orderComplete.summary.orderNumber"),":"]}),(0,s.jsx)("span",{className:d().value,children:m.order_number})]}),(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsxs)("span",{className:d().label,children:[e("orderComplete.summary.total"),":"]}),(0,s.jsxs)("span",{className:d().value,children:["$",j(m.total_amount)]})]}),(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsxs)("span",{className:d().label,children:[e("orderComplete.summary.paymentStatus"),":"]}),(0,s.jsx)("span",{className:"".concat(d().value," ").concat(d().statusPaid),children:e("orders.paymentStatus.".concat(m.payment_status))})]}),(0,s.jsxs)("div",{className:d().summaryItem,children:[(0,s.jsxs)("span",{className:d().label,children:[e("orderComplete.summary.orderStatus"),":"]}),(0,s.jsx)("span",{className:d().value,children:e("orders.status.".concat(m.status))})]})]}),(0,s.jsxs)("div",{className:d().itemsPreview,children:[(0,s.jsx)("h3",{className:d().itemsTitle,children:e("orderComplete.items.title")}),(0,s.jsxs)("div",{className:d().itemsList,children:[m.items.slice(0,3).map(t=>(0,s.jsxs)("div",{className:d().orderItem,children:[(0,s.jsx)("img",{src:t.image||"/placeholder-product.png",alt:t.name,className:d().itemImage}),(0,s.jsxs)("div",{className:d().itemDetails,children:[(0,s.jsx)("span",{className:d().itemName,children:t.name}),(0,s.jsxs)("span",{className:d().itemQuantity,children:[e("orderComplete.items.quantity"),": ",t.quantity]})]}),(0,s.jsxs)("span",{className:d().itemPrice,children:["$",j(C(t.price)*t.quantity)]})]},t.id)),m.items.length>3&&(0,s.jsx)("div",{className:d().moreItems,children:e("orderComplete.items.andMore",{count:m.items.length-3})})]})]})]}),(0,s.jsxs)("div",{className:d().nextSteps,children:[(0,s.jsx)("h3",{className:d().nextStepsTitle,children:e("orderComplete.nextSteps.title")}),(0,s.jsxs)("ul",{className:d().stepsList,children:[(0,s.jsx)("li",{children:e("orderComplete.nextSteps.confirmation")}),(0,s.jsx)("li",{children:e("orderComplete.nextSteps.processing")}),(0,s.jsx)("li",{children:e("orderComplete.nextSteps.shipping")}),(0,s.jsx)("li",{children:e("orderComplete.nextSteps.tracking")})]})]}),(0,s.jsxs)("div",{className:d().actions,children:[(0,s.jsx)("button",{onClick:()=>{m&&t.push("/orders/".concat(m.id))},className:d().primaryButton,children:e("orderComplete.actions.viewOrder")}),(0,s.jsx)("button",{onClick:x,className:d().secondaryButton,children:e("orderComplete.actions.continueShopping")})]})]})})})}},3447:e=>{e.exports={completePage:"orderComplete_completePage__VBNyh",container:"orderComplete_container__1AWZK",loadingState:"orderComplete_loadingState__XdTg8",spinner:"orderComplete_spinner__yLpoy",spin:"orderComplete_spin__SYPV_",errorState:"orderComplete_errorState__Jtetn",errorIcon:"orderComplete_errorIcon__ZTiUU",errorTitle:"orderComplete_errorTitle__rKeak",errorMessage:"orderComplete_errorMessage__jkoJT",successState:"orderComplete_successState__ZjvM_",successIcon:"orderComplete_successIcon__51aNq",successTitle:"orderComplete_successTitle__GKLLe",successMessage:"orderComplete_successMessage__NyB_p",orderSummary:"orderComplete_orderSummary__u_nq7",summaryTitle:"orderComplete_summaryTitle__1Jlg3",summaryGrid:"orderComplete_summaryGrid__u9RWl",summaryItem:"orderComplete_summaryItem__L49fo",label:"orderComplete_label__By6h0",value:"orderComplete_value__RJSQ4",statusPaid:"orderComplete_statusPaid__8E4vs",itemsPreview:"orderComplete_itemsPreview__rU39i",itemsTitle:"orderComplete_itemsTitle__K8cTC",itemsList:"orderComplete_itemsList__qwDeT",orderItem:"orderComplete_orderItem__KZbrS",itemImage:"orderComplete_itemImage__epiVu",itemDetails:"orderComplete_itemDetails__ZaM3G",itemName:"orderComplete_itemName__jgxU6",itemQuantity:"orderComplete_itemQuantity__dzTmF",itemPrice:"orderComplete_itemPrice__0HkhO",moreItems:"orderComplete_moreItems__M2lfF",nextSteps:"orderComplete_nextSteps__NwBrp",nextStepsTitle:"orderComplete_nextStepsTitle__TFwiL",stepsList:"orderComplete_stepsList__tT4is",actions:"orderComplete_actions__t3DhH",primaryButton:"orderComplete_primaryButton__2OfuW",secondaryButton:"orderComplete_secondaryButton__ftY9_"}},4015:(e,t,r)=>{Promise.resolve().then(r.bind(r,1451))},5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},9493:(e,t,r)=>{"use strict";r.d(t,{FK:()=>a,It:()=>n,N4:()=>l,fS:()=>o,mK:()=>u,p:()=>i,u:()=>c});let s="http://localhost:8000/api/v1";async function a(e,t){let r=new URL("".concat(s,"/orders/"));t&&(t.status&&"all"!==t.status&&r.searchParams.append("status",t.status),t.ordering&&r.searchParams.append("ordering",t.ordering),t.page&&r.searchParams.append("page",t.page.toString()),t.page_size&&r.searchParams.append("page_size",t.page_size.toString()));let a=await fetch(r.toString(),{method:"GET",headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!a.ok){if(401===a.status)throw Error("Unauthorized - please log in again");throw Error("Failed to fetch orders: ".concat(a.statusText))}let o=await a.json();return{...o,results:o.results.map(m)}}async function o(e,t){console.log("=== CREATE ORDER API CALLED ==="),console.log("API URL:","".concat(s,"/orders/create/")),console.log("Order data:",e),console.log("Token available:",!!t);let r=await fetch("".concat(s,"/orders/create/"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"},body:JSON.stringify(e)});if(console.log("=== CREATE ORDER RESPONSE ==="),console.log("Status:",r.status),console.log("Status text:",r.statusText),console.log("Response OK:",r.ok),!r.ok){let e=await r.json();throw console.error("=== CREATE ORDER ERROR RESPONSE ==="),console.error("Error data:",e),Error(e.message||"Failed to create order")}let a=await r.json();console.log("=== CREATE ORDER SUCCESS ==="),console.log("Backend order response:",a);let o=m(a);return console.log("Transformed order:",o),o}async function n(e,t,r){let a={"Content-Type":"application/json"};r&&(a.Authorization="Bearer ".concat(r));let o=await fetch("".concat(s,"/orders/payment-callback/"),{method:"POST",headers:a,body:JSON.stringify({uid:e,status:"paid"===t?"success":"failed"})});if(!o.ok)throw Error((await o.json()).message||"Failed to update order payment status");if((await o.json()).success&&r)return i(String(e),r);throw Error("Payment status update failed")}async function i(e,t){let r=await fetch("".concat(s,"/orders/").concat(e,"/"),{method:"GET",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!r.ok){if(401===r.status)throw Error("Unauthorized - please log in again");if(404===r.status)throw Error("Order not found");throw Error("Failed to fetch order: ".concat(r.statusText))}return m(await r.json())}async function l(e,t){let r=await fetch("".concat(s,"/orders/").concat(e,"/cancel/"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!r.ok){if(401===r.status)throw Error("Unauthorized - please log in again");if(404===r.status)throw Error("Order not found");if(400===r.status)throw Error((await r.json()).detail||"Cannot cancel this order");throw Error("Failed to cancel order: ".concat(r.statusText))}return m(await r.json())}async function c(e,t){let r=await fetch("".concat(s,"/orders/").concat(e,"/reorder/"),{method:"POST",headers:{Authorization:"Bearer ".concat(t),"Content-Type":"application/json"}});if(!r.ok){if(401===r.status)throw Error("Unauthorized - please log in again");if(404===r.status)throw Error("Order not found");if(400===r.status)throw Error((await r.json()).detail||"Cannot reorder these items");throw Error("Failed to reorder items: ".concat(r.statusText))}return r.json()}function d(e){return{id:e.id,product_id:e.product_id,variant_id:e.variant_id,product_name:e.product_name,variant_name:e.variant_name,product_image:e.product_image,product_slug:e.product_slug,price:e.price,quantity:e.quantity,color:e.color,size:e.size,subtotal:e.subtotal,sku_snapshot:e.sku_snapshot,name:e.product_name,image:e.product_image||"/placeholder-product.png",variant:e.variant_name}}function m(e){var t,r,s,a,o,n;console.log("Transforming backend order:",e);let i=e.shipping_address_details||e.shipping_address||{};return console.log("Shipping address details:",i),console.log("User fields from backend:",{user_first_name:e.user_first_name,user_last_name:e.user_last_name,user_email:e.user_email,user_phone:e.user_phone,email_for_guest:e.email_for_guest}),{id:e.order_id||e.id,order_number:e.order_number,status:({pending_payment:"pending",processing:"processing",shipped:"shipped",delivered:"delivered",cancelled:"cancelled",refunded:"cancelled",failed:"cancelled"})[e.order_status]||"pending",payment_status:({pending:"pending",paid:"paid",failed:"failed",refunded_partial:"refunded",refunded_full:"refunded"})[e.payment_status]||"pending",created_at:e.created_at,updated_at:e.updated_at,total_amount:e.total_amount,shipping_cost:e.shipping_cost,discount_amount:e.discount_amount,subtotal_amount:e.subtotal_amount,items:(null==(t=e.items)?void 0:t.map(d))||[],shipping_address:{first_name:(null==(r=i.recipient_name)?void 0:r.split(" ")[0])||i.first_name||"",last_name:(null==(s=i.recipient_name)?void 0:s.split(" ").slice(1).join(" "))||i.last_name||"",street_address:i.street_address||i.address_line_1||"",city:i.city||"",state:i.state_province||i.state||i.region||"",postal_code:i.postal_code||i.zip_code||"",country:i.country_code||i.country||"",phone:i.phone_number||i.phone||""},shipping_method:(null==(a=e.shipping_method_details)?void 0:a.name)||e.shipping_method||"Standard",shipping_method_details:e.shipping_method_details,tracking_number:e.tracking_number,estimated_delivery:e.estimated_delivery,customer_info:{first_name:e.user_first_name||(null==(o=i.recipient_name)?void 0:o.split(" ")[0])||"",last_name:e.user_last_name||(null==(n=i.recipient_name)?void 0:n.split(" ").slice(1).join(" "))||"",email:e.user_email||e.email_for_guest||"",phone:e.user_phone||i.phone_number||""}}}async function u(e,t){console.log("=== CREATE DIRECT ORDER API CALLED ==="),console.log("API URL:","".concat(s,"/orders/create-direct/")),console.log("Order data:",e),console.log("Token available:",!!t);let r={"Content-Type":"application/json"};t&&(r.Authorization="Bearer ".concat(t));let a=await fetch("".concat(s,"/orders/create-direct/"),{method:"POST",headers:r,body:JSON.stringify(e)});if(console.log("=== CREATE DIRECT ORDER RESPONSE ==="),console.log("Status:",a.status),console.log("Status text:",a.statusText),console.log("Response OK:",a.ok),!a.ok){let e=await a.json();throw console.error("=== CREATE DIRECT ORDER ERROR RESPONSE ==="),console.error("Error data:",e),Error(e.message||"Failed to create direct order")}let o=await a.json();console.log("=== CREATE DIRECT ORDER SUCCESS ==="),console.log("Backend order response:",o);let n=m(o);return console.log("Transformed direct order:",n),n}}},e=>{var t=t=>e(e.s=t);e.O(0,[960,4540,5295,8441,1684,7358],()=>t(4015)),_N_E=e.O()}]);