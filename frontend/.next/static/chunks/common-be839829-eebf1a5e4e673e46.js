"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6373],{167:(e,t,r)=>{r.d(t,{I1:()=>c,P_:()=>i,bulkAddToCart:()=>u,r5:()=>n,updateCartItemQuantity:()=>g,vI:()=>l,vM:()=>d,zA:()=>s});var a=r(6063),o=r(722);async function n(e,t){try{return(await o.A.post("/carts/".concat(e,"/items/"),t)).data}catch(e){return console.error("Error adding item to cart:",e),null}}async function s(){try{return(await o.A.post("/carts/",{})).data}catch(e){return console.error("Error creating cart:",e),null}}async function c(e){try{return(await o.A.post("/carts/sync/",e)).data.cart}catch(e){return console.error("Error syncing cart:",e),null}}async function l(e){try{return(await o.A.post("/carts/merge/",e)).data.cart}catch(e){return console.error("Error merging guest cart:",e),null}}async function i(e){try{let t={};return e&&(t["X-Cart-ID"]=e),(await o.A.get("/carts/mine/",{headers:t})).data}catch(e){var t;if((null==(t=e.response)?void 0:t.status)===404)return null;return console.error("Error fetching my cart:",e),null}}async function u(e,t){try{let r={};return t&&(r["X-Cart-ID"]=t),(await o.A.post("/carts/bulk-add/",{items:e},{headers:r})).data}catch(e){return console.error("Error bulk adding to cart:",e),null}}function d(e){return e.map(e=>(0,a.s)(e)).filter(e=>e.drop_product_id||e.product_variant_id)}async function g(e){try{let t={quantity:e.quantity,color:e.color,color_code:void 0,size:e.size};return e.variantId?t.product_variant_id=e.variantId:t.drop_product_id=e.itemId,await u([t])}catch(e){return console.error("Error updating cart item quantity:",e),null}}},722:(e,t,r)=>{r.d(t,{A:()=>o});let a=r(6233).Ay.create({baseURL:"http://localhost:8000/api/v1",headers:{"Content-Type":"application/json"},timeout:15e3,maxRedirects:3,decompress:!0});a.interceptors.request.use(e=>{{let t=localStorage.getItem("access_token");t&&(e.headers.Authorization="Bearer ".concat(t))}return e},e=>(console.error("API Request Error:",e),Promise.reject(e))),a.interceptors.response.use(e=>e,e=>{var t;return e.response&&(401===e.response.status&&(console.error("Authentication error. Please login again."),localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")),e.response.status>=500&&console.error("Server error. Please try again later.")),"ECONNABORTED"===e.code&&console.error("Request timeout. Please check your connection."),console.error("API Response Error:",(null==(t=e.response)?void 0:t.data)||e.message),Promise.reject(e)});let o=a},2265:(e,t,r)=>{r.d(t,{Ay:()=>f,DY:()=>s,ET:()=>g,Lx:()=>n,l2:()=>c,ri:()=>d,uM:()=>h,w2:()=>i});var a=r(4562);let o="http://localhost:8000/api/v1",n=(0,a.zD)("auth/login",async(e,t)=>{let{rejectWithValue:r}=t;try{let t=await fetch("".concat(o,"/auth/login/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();return r(e)}let a=await t.json();return localStorage.setItem("access_token",a.access),localStorage.setItem("refresh_token",a.refresh),a}catch(e){return r({message:"Ошибка сети"})}}),s=(0,a.zD)("auth/register",async(e,t)=>{let{rejectWithValue:r}=t;try{let t=await fetch("".concat(o,"/auth/register/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();return r(e)}return await t.json()}catch(e){return r({message:"Ошибка сети"})}}),c=(0,a.zD)("auth/fetchProfile",async(e,t)=>{let{rejectWithValue:r,getState:a}=t;try{let e=a().auth.token||localStorage.getItem("access_token");if(!e)return r({message:"Нет токена авторизации"});let t=await fetch("".concat(o,"/auth/profile/"),{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(!t.ok){if(401===t.status)throw Error("Token expired");let e=await t.json();return r(e)}return await t.json()}catch(e){return r({message:"Ошибка получения профиля"})}}),l=(0,a.zD)("auth/refreshToken",async(e,t)=>{let{rejectWithValue:r}=t;try{let e=localStorage.getItem("refresh_token");if(!e)return r({message:"Нет refresh токена"});let t=await fetch("".concat(o,"/auth/login/refresh/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({refresh:e})});if(!t.ok){let e=await t.json();return r(e)}let a=await t.json();return localStorage.setItem("access_token",a.access),a}catch(e){return r({message:"Ошибка обновления токена"})}}),i=(0,a.zD)("auth/requestPasswordReset",async(e,t)=>{let{rejectWithValue:r}=t;try{let t=await fetch("".concat(o,"/auth/password-reset/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})});if(!t.ok){let e=await t.json();return r(e)}return await t.json()}catch(e){return r({message:"Ошибка сети"})}}),u=(0,a.Z0)({name:"auth",initialState:{user:null,token:null,refreshToken:null,isLoading:!1,error:null,isAuthenticated:!1,isInitialized:!1},reducers:{logout:e=>{e.user=null,e.token=null,e.refreshToken=null,e.isAuthenticated=!1,e.error=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")},clearError:e=>{e.error=null},loadTokensFromStorage:e=>{let t=localStorage.getItem("access_token"),r=localStorage.getItem("refresh_token");t&&r&&(e.token=t,e.refreshToken=r,e.isAuthenticated=!0),e.isInitialized=!0},setTokens:(e,t)=>{e.token=t.payload.access,e.refreshToken=t.payload.refresh,e.isAuthenticated=!0}},extraReducers:e=>{e.addCase(n.pending,e=>{e.isLoading=!0,e.error=null}).addCase(n.fulfilled,(e,t)=>{e.isLoading=!1,e.token=t.payload.access,e.refreshToken=t.payload.refresh,e.isAuthenticated=!0,e.error=null}).addCase(n.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1}).addCase(s.pending,e=>{e.isLoading=!0,e.error=null}).addCase(s.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload,e.error=null}).addCase(s.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload}).addCase(c.pending,e=>{e.isLoading=!0}).addCase(c.fulfilled,(e,t)=>{e.isLoading=!1,e.user=t.payload,e.error=null}).addCase(c.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload,e.isAuthenticated=!1,e.token=null,e.refreshToken=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}).addCase(l.fulfilled,(e,t)=>{e.token=t.payload.access}).addCase(l.rejected,e=>{e.isAuthenticated=!1,e.token=null,e.refreshToken=null,localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")}).addCase(i.pending,e=>{e.isLoading=!0,e.error=null}).addCase(i.fulfilled,e=>{e.isLoading=!1,e.error=null}).addCase(i.rejected,(e,t)=>{e.isLoading=!1,e.error=t.payload})}}),{logout:d,clearError:g,loadTokensFromStorage:h,setTokens:p}=u.actions,f=u.reducer},9604:(e,t,r)=>{r.d(t,{AS:()=>i,FY:()=>l,M$:()=>u,bW:()=>d,ow:()=>c});var a=r(722);let o=new Map;function n(e){let t=o.get(e);return t&&Date.now()-t.timestamp<3e5?t.data:(o.delete(e),null)}function s(e,t){o.set(e,{data:t,timestamp:Date.now()})}let c=(e,t)=>{let r=e.image||"/placeholder-slider.jpg";return{id:e.id||t+1,type:"image",src:r,alt:e.name||"Category ".concat(t+1),slug:e.slug,title:e.name,description:e.description||"Explore our collection"}};async function l(){let e="products_lcp_first_page",t=n(e);if(t)return t;try{let t=(await a.A.get("/products/?page=1&page_size=8")).data.results||[];return s(e,t),t}catch(e){return console.error("Error fetching LCP products:",e),[]}}async function i(){let e="all_products",t=n(e);if(t)return t;try{let t=[],r=1,o=!0;for(;o;){let e=await a.A.get("/products/?page=".concat(r,"&page_size=50"));t=[...t,...e.data.results||[]],o=!!e.data.next,r++}return s(e,t),t}catch(e){return console.error("Error fetching all products:",e),[]}}async function u(e){let t="product_".concat(e),r=n(t);if(r)return r;try{let r=(await a.A.get("/products/".concat(e,"/"))).data;return s(t,r),r}catch(t){var o;if((null==(o=t.response)?void 0:o.status)===404)return null;return console.error("Error fetching product with slug ".concat(e,":"),t),null}}async function d(e){let t="categories_".concat(e?"featured":"all"),r=n(t);if(r)return r;try{let r="/categories/";e&&(r+="?is_featured=true");let o=(await a.A.get(r)).data.results||[];return s(t,o),o}catch(e){return console.error("Error fetching categories:",e),[]}}}}]);