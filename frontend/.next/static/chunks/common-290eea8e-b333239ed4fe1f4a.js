"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8852],{2045:(a,t,e)=>{e.d(t,{G:()=>o,j:()=>d});var r=e(4540);let d=()=>(0,r.wA)(),o=r.d4},4089:(a,t,e)=>{e.d(t,{Ay:()=>D,Bb:()=>S,RO:()=>h,So:()=>s,dt:()=>f,sL:()=>p,sX:()=>C,tA:()=>u,u$:()=>z});var r=e(4562),d=e(167),o=e(6063);let i=()=>{try{let a=localStorage.getItem("cart");return a?JSON.parse(a):[]}catch(a){return console.error("Error loading cart from localStorage:",a),[]}},l=a=>{try{localStorage.setItem("cart",JSON.stringify(a))}catch(a){console.error("Error saving cart to localStorage:",a)}},c=()=>{try{return localStorage.getItem("cartId")||void 0}catch(a){console.error("Error loading cart ID from localStorage:",a);return}},n=a=>{try{a?localStorage.setItem("cartId",a):localStorage.removeItem("cartId")}catch(a){console.error("Error saving cart ID to localStorage:",a)}},s=(0,r.zD)("cart/syncWithBackend",async(a,t)=>{let{getState:e,rejectWithValue:r}=t;try{let a=e(),t=(0,d.vM)(a.cart.items),r=a.cart.cartId,o=await (0,d.I1)({items:t,guest_cart_id:r});if(!o)throw Error("Failed to sync cart with backend");return o}catch(a){return r(a.message||"Failed to sync cart")}}),p=(0,r.zD)("cart/mergeGuestCart",async(a,t)=>{let{guestCartId:e,strategy:r}=a,{rejectWithValue:o}=t;try{let a=await (0,d.vI)({guest_cart_id:e,merge_strategy:r});if(!a)throw Error("Failed to merge guest cart");return a}catch(a){return o(a.message||"Failed to merge cart")}}),u=(0,r.zD)("cart/loadFromBackend",async function(){let a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{rejectWithValue:t}=arguments.length>1?arguments[1]:void 0;try{return await (0,d.P_)(a.guestCartId)}catch(a){return t(a.message||"Failed to load cart from backend")}}),y=(0,r.zD)("cart/bulkAddToUserCart",async(a,t)=>{let{getState:r,rejectWithValue:o}=t;try{let a=r(),{bulkAddToCart:t}=await Promise.resolve().then(e.bind(e,167)),o=(0,d.vM)(a.cart.items);if(0===o.length)return null;let i=await t(o);if(!i)throw Error("Failed to bulk add items to cart");return i}catch(a){return o(a.message||"Failed to bulk add items to cart")}}),_=(0,r.zD)("cart/addToCartAPI",async(a,t)=>{let{getState:r,rejectWithValue:d}=t;try{let t=r(),{bulkAddToCart:d}=await Promise.resolve().then(e.bind(e,167)),i=[(0,o.s)(a)].filter(a=>a.drop_product_id||a.product_variant_id);if(0===i.length)throw Error("Invalid item to add to cart");let l=await d(i,t.cart.cartId);if(!l)throw Error("Failed to add item to cart");return l}catch(a){return d(a.message||"Failed to add item to cart")}}),m=(0,r.zD)("cart/updateCartItemQuantityAPI",async(a,t)=>{let{getState:r,rejectWithValue:d}=t;try{r();let{updateCartItemQuantity:t}=await Promise.resolve().then(e.bind(e,167)),d=await t({itemId:a.id,variantId:a.variantId,color:a.color,size:a.size,quantity:a.quantity});if(!d)throw Error("Failed to update cart item quantity");return d}catch(a){return d(a.message||"Failed to update cart item quantity")}}),g={items:i(),cartId:c(),isLoading:!1,needsSync:!1,lastSyncTime:void 0},v=(0,r.Z0)({name:"cart",initialState:g,reducers:{addToCart:(a,t)=>{let e=a.items.find(a=>a.id===t.payload.id&&a.variantId===t.payload.variantId&&a.color===t.payload.color&&a.size===t.payload.size);e?e.quantity+=t.payload.quantity||1:a.items.push(t.payload),l(a.items),a.needsSync=!0},removeFromCart:(a,t)=>{a.items=a.items.filter(a=>a.id!==t.payload.id||a.variantId!==t.payload.variantId||a.color!==t.payload.color||a.size!==t.payload.size),l(a.items),a.needsSync=!0},updateQuantity:(a,t)=>{let e=a.items.find(a=>a.id===t.payload.id&&a.variantId===t.payload.variantId&&a.color===t.payload.color&&a.size===t.payload.size);e&&(e.quantity=Math.max(1,Math.floor(t.payload.quantity))),l(a.items),a.needsSync=!0},clearCart:a=>{a.items=[],a.needsSync=!1,l([])},loadCart:a=>{a.items=i(),a.cartId=c()},setCartId:(a,t)=>{a.cartId=t.payload,n(t.payload)},markAsSynced:a=>{a.needsSync=!1,a.lastSyncTime=Date.now()},setCartFromBackend:(a,t)=>{a.items=t.payload.items.map(a=>(0,o.E)(a)),a.cartId=t.payload.cart_id,a.needsSync=!1,a.lastSyncTime=Date.now(),l(a.items),n(t.payload.cart_id)}},extraReducers:a=>{a.addCase(s.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(s.fulfilled,(a,t)=>{a.isLoading=!1,a.needsSync=!1,a.lastSyncTime=Date.now(),t.payload.cart_id&&(a.cartId=t.payload.cart_id,n(t.payload.cart_id))}).addCase(s.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload}),a.addCase(p.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(p.fulfilled,(a,t)=>{a.isLoading=!1,a.needsSync=!1,a.lastSyncTime=Date.now(),a.items=t.payload.items.map(a=>(0,o.E)(a)),a.cartId=t.payload.cart_id,l(a.items),n(t.payload.cart_id)}).addCase(p.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload}),a.addCase(u.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(u.fulfilled,(a,t)=>{a.isLoading=!1,t.payload&&(a.items=t.payload.items.map(a=>(0,o.E)(a)),t.payload.cart_id&&(a.cartId=t.payload.cart_id,n(t.payload.cart_id)),a.needsSync=!1,a.lastSyncTime=Date.now(),l(a.items))}).addCase(u.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload}),a.addCase(y.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(y.fulfilled,(a,t)=>{a.isLoading=!1,a.needsSync=!1,a.lastSyncTime=Date.now(),t.payload&&(a.items=t.payload.items.map(a=>(0,o.E)(a)),t.payload.cart_id&&(a.cartId=t.payload.cart_id,n(t.payload.cart_id)),l(a.items))}).addCase(y.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload}),a.addCase(_.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(_.fulfilled,(a,t)=>{a.isLoading=!1,a.needsSync=!1,a.lastSyncTime=Date.now(),t.payload&&(a.items=t.payload.items.map(a=>(0,o.E)(a)),t.payload.cart_id&&(a.cartId=t.payload.cart_id,n(t.payload.cart_id)),l(a.items))}).addCase(_.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload}).addCase(m.pending,a=>{a.isLoading=!0,a.error=void 0}).addCase(m.fulfilled,(a,t)=>{a.isLoading=!1,a.needsSync=!1,a.lastSyncTime=Date.now(),t.payload&&(a.items=t.payload.items.map(a=>(0,o.E)(a)),t.payload.cart_id&&(a.cartId=t.payload.cart_id,n(t.payload.cart_id)),l(a.items))}).addCase(m.rejected,(a,t)=>{a.isLoading=!1,a.error=t.payload})}}),{addToCart:I,removeFromCart:f,updateQuantity:h,clearCart:C,loadCart:S,setCartId:w,markAsSynced:z,setCartFromBackend:L}=v.actions,D=v.reducer},6063:(a,t,e)=>{function r(a){var t,e,r,d,o,i,l,c,n,s,p,u;let y,_,m,g,v;if(a.drop_product_details?y={name:a.drop_product_details.product.name,basePrice:a.drop_product_details.product.base_price}:(null==(t=a.product_variant_details)?void 0:t.product_details)&&(y={name:a.product_variant_details.product_details.name,basePrice:parseFloat(a.product_variant_details.product_details.base_price)}),null==(e=a.product_variant_details)?void 0:e.image)_=a.product_variant_details.image;else if((null==(r=a.product_variant_details)?void 0:r.images)&&a.product_variant_details.images.length>0){let t=a.product_variant_details.images.find(a=>a.is_primary);_=t?t.image:a.product_variant_details.images[0].image}else if((null==(o=a.product_variant_details)||null==(d=o.product_details)?void 0:d.images)&&a.product_variant_details.product_details.images.length>0){let t=a.product_variant_details.product_details.images.find(a=>a.is_primary);_=t?t.image:a.product_variant_details.product_details.images[0].image}else(null==(i=a.drop_product_details)?void 0:i.image)&&(_=a.drop_product_details.image);return a.color?m=a.color:(null==(c=a.product_variant_details)||null==(l=c.color_info)?void 0:l.name)&&(m=a.product_variant_details.color_info.name),a.color_code?g=a.color_code:(null==(s=a.product_variant_details)||null==(n=s.color_info)?void 0:n.hex_code)&&(g=a.product_variant_details.color_info.hex_code),a.size?v=a.size:(null==(u=a.product_variant_details)||null==(p=u.size_info)?void 0:p.name)&&(v=a.product_variant_details.size_info.name),{id:a.drop_product||a.product_variant||a.id,variantId:a.product_variant||void 0,dropProductId:a.drop_product||void 0,isDropProduct:!!a.drop_product,name:(null==y?void 0:y.name)||"Unknown Product",price:a.unit_price,quantity:a.quantity,image:_,color:m,colorCode:g,size:v}}function d(a){return a.isDropProduct||a.dropProductId?{drop_product_id:a.dropProductId||a.id,quantity:a.quantity,color:a.color||void 0,color_code:a.colorCode||void 0,size:a.size||void 0}:a.variantId?{product_variant_id:a.variantId,quantity:a.quantity,color:a.color||void 0,color_code:a.colorCode||void 0,size:a.size||void 0}:(console.warn("Product without variant ID found in cart:",a),{quantity:a.quantity,color:a.color||void 0,color_code:a.colorCode||void 0,size:a.size||void 0})}e.d(t,{E:()=>r,s:()=>d})}}]);